require(["zepto","mcommon"],function(a,b){function c(){null!=sessionStorage.financeType&&""!=sessionStorage.financeType&&void 0!=sessionStorage.financeType&&a("#financeType").val(sessionStorage.financeType),null!=sessionStorage.companyname&&""!=sessionStorage.companyname&&void 0!=sessionStorage.companyname&&a("#companyname").val(sessionStorage.companyname),null!=sessionStorage.address&&""!=sessionStorage.address&&void 0!=sessionStorage.address&&a("#address").val(sessionStorage.address),null!=sessionStorage.businessarea&&""!=sessionStorage.businessarea&&void 0!=sessionStorage.businessarea&&a("#businessarea").val(sessionStorage.businessarea),null!=sessionStorage.amountnum&&""!=sessionStorage.amountnum&&void 0!=sessionStorage.amountnum&&a("#amountnum").val(sessionStorage.amountnum),null!=sessionStorage.contact&&""!=sessionStorage.contact&&void 0!=sessionStorage.contact&&a("#contact").val(sessionStorage.contact),null!=sessionStorage.phone&&""!=sessionStorage.phone&&void 0!=sessionStorage.phone&&a("#phone").val(sessionStorage.phone)}function d(b){a(".backLayer").show(),a("#apply-model-"+b).addClass("md-show"),a("body,html").css({overflow:"hidden"})}function e(b){a("#apply-model-"+b).removeClass("md-show"),a(".backLayer").hide(),a("body,html").css({overflow:""})}function f(a,b){a.val(""),b.css("visibility","hidden")}function g(a,b){""==a.val()?b.css("visibility","hidden"):b.css("visibility","visible")}function h(){return""==a("#companyname").val()?(a("#companynameError").text("请填写公司名称").show(),!1):a("#companyname").val().length>50?(a("#companynameError").text("公司名称最多输入50个字符").show(),!1):(a("#companynameError").text("").hide(),!0)}function i(){return""==a("#address").val()?(a("#addressError").text("请填写公司地址").show(),!1):a("#address").val().length>50?(a("#addressError").text("公司地址最多输入50个字符").show(),!1):(a("#addressError").text("").hide(),!0)}function j(){return""==a("#businessarea").val()?(a("#businessareaError").text("请填写业务区域").show(),!1):a("#businessarea").val().length>50?(a("#businessareaError").text("业务区域最多输入50个字符").show(),!1):(a("#businessareaError").text("").hide(),!0)}function k(){return""==a("#amountnum").val()?(a("#amountnumError").text("请填写融资金额").show(),!1):p.test(a("#amountnum").val())?a("#amountnum").val()>1e4?(a("#amountnumError").text("融资金额不超过1亿").show(),!1):(a("#amountnumError").text("").hide(),!0):(a("#amountnumError").text("请正确输入金额，限一位小数").show(),!1)}function l(){return""==a("#contact").val()?(a("#contactError").text("请填写联系人").show(),!1):a("#contact").val().length>50?(a("#contactError").text("联系人最多输入50个字符").show(),!1):(a("#contactError").text("").hide(),!0)}function m(){return""==a("#phone").val()?(a("#phoneError").text("请填写联系电话").show(),!1):q.test(a("#phone").val())||r.test(a("#phone").val())?(a("#phoneError").text("").hide(),!0):(a("#phoneError").text("请正确填写联系电话").show(),!1)}function n(){return""==a("#imagecode").val()?(a("#imagecodeError").text("请输入图片验证码").show(),!1):4!=a("#imagecode").val().length?(a("#imagecodeError").text("请输入正确的图片验证码").show(),!1):(a("#imagecodeError").text("").hide(),!0)}c();var o=a("#flag").val();(""==o||null==o)&&(o="easyFinancing"),a("#"+o+"_tab a").css("color","#2999e1"),a("#"+o+"_line").show(),a("#requireBtn").click(function(b){a("#"+o+"_div").addClass("divFixed"),d(o),a("body,html").height(a(window).height()),b.preventDefault()}),a(".md-modal").click(function(){a("#"+o+"_div").removeClass("divFixed"),e(o)}),a(".applyBtn").on("click",function(){var b="/m/financeApply/"+a("#flag").val();location.href=b}),a("#back").on("click",function(){location.href="/m/finance/"+a("#flag").val()}),a("#companynameDel").on("click",function(){f(a("#companyname"),a(this)),h()}),a("#addressDel").on("click",function(){f(a("#address"),a(this)),i()}),a("#businessareaDel").on("click",function(){f(a("#businessarea"),a(this)),j()}),a("#contactDel").on("click",function(){f(a("#contact"),a(this)),l()}),a("#phoneDel").on("click",function(){f(a("#phone"),a(this)),m()}),a("#imagecodeDel").on("click",function(){f(a("#imagecode"),a(this)),n()}),a("#companyname").on("blur",function(){g(a("#companyname"),a("#companynameDel")),h()}),a("#companyname").on("keyup",function(){g(a("#companyname"),a("#companynameDel"))}),a("#address").on("blur",function(){g(a("#address"),a("#addressDel")),i()}),a("#address").on("keyup",function(){g(a("#address"),a("#addressDel"))}),a("#businessarea").on("blur",function(){g(a("#businessarea"),a("#businessareaDel")),j()}),a("#businessarea").on("keyup",function(){g(a("#businessarea"),a("#businessareaDel"))});var p=/^(\d+(\.\d)?)$/;a("#amountnum").on("blur",function(){k()}),a("#contact").on("blur",function(){g(a("#contact"),a("#contactDel")),l()}),a("#contact").on("keyup",function(){g(a("#contact"),a("#contactDel"))});var q=/^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/,r=/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;a("#phone").on("blur",function(){g(a("#phone"),a("#phoneDel")),m()}),a("#phone").on("keyup",function(){g(a("#phone"),a("#phoneDel"))}),a("#btn_apply").click(function(){h()&i()&j()&k()&l()&m()&n()&&(sessionStorage.financeType=a("#financeType").val(),sessionStorage.companyname=a("#companyname").val(),sessionStorage.address=a("#address").val(),sessionStorage.businessarea=a("#businessarea").val(),sessionStorage.amountnum=a("#amountnum").val(),sessionStorage.contact=a("#contact").val(),sessionStorage.phone=a("#phone").val(),sessionStorage.imagecode=a("#imagecode").val(),a.ajax({url:"/m/finance/add",type:"POST",data:{type:a("#financeType").val(),companyname:a("#companyname").val(),address:a("#address").val(),businessarea:a("#businessarea").val(),amountnum:a("#amountnum").val(),contact:a("#contact").val(),phone:a("#phone").val(),imagecode:a("#imagecode").val()},success:function(b){b.success?(sessionStorage.financeType="",sessionStorage.companyname="",sessionStorage.address="",sessionStorage.businessarea="",sessionStorage.amountnum="",sessionStorage.contact="",sessionStorage.phone="",sessionStorage.imagecode="",location.href="/m/finance/goToFinanceSuccess"):(a("#verifycode").attr("src","/verifyCode?date="+(new Date).getTime()),""!=b.error?"imagecode"==b.errortype?a("#imagecodeError").html("").text(b.error).show():a("#systemError").html("").text(b.error).show():a("#systemError").html("").text("系统出错了,已自动通知我们的团队,我们会尽快修复!").show())}}))})});